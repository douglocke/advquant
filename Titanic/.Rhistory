summary(titanic_2)
exp(coef(titanic_2))
prob_2 = predict(titanic_2,type="response")
titanic$prob_2 <- prob_2
quantile(titanic$prob_2)
# (2) Run Diagnostics
pred_2 = rep("Died", 564)
pred_2[titanic$prob_2>0.50] = "Survived"
titanic$pred_2 <- pred_2
table(pred_2,titanic$Survived_value)
misClassifiError = mean(pred_2 != titanic$Survived_value)
print(paste('Accuracy', 1 - misClassifiError))
titanic_2 <- glm(Survived ~ female + Class_1 + Age_0_10 + SibSp_isMulti + SibSp_isOne, family=binomial, data=titanic)
summary(titanic_2)
exp(coef(titanic_2))
prob_2 = predict(titanic_2,type="response")
titanic$prob_2 <- prob_2
quantile(titanic$prob_2)
# (2) Run Diagnostics
pred_2 = rep("Died", 564)
pred_2[titanic$prob_2>0.50] = "Survived"
titanic$pred_2 <- pred_2
table(pred_2,titanic$Survived_value)
misClassifiError = mean(pred_2 != titanic$Survived_value)
print(paste('Accuracy', 1 - misClassifiError))
titanic_2 <- glm(Survived ~ female + Class_1 + Age_0_10 + SibSp_isMulti + Parch_isOne, family=binomial, data=titanic)
summary(titanic_2)
exp(coef(titanic_2))
prob_2 = predict(titanic_2,type="response")
titanic$prob_2 <- prob_2
quantile(titanic$prob_2)
# (2) Run Diagnostics
pred_2 = rep("Died", 564)
pred_2[titanic$prob_2>0.50] = "Survived"
titanic$pred_2 <- pred_2
table(pred_2,titanic$Survived_value)
misClassifiError = mean(pred_2 != titanic$Survived_value)
print(paste('Accuracy', 1 - misClassifiError))
pred_2 = rep("Died", 564)
pred_2[titanic$prob_2>0.46] = "Survived"
titanic$pred_2 <- pred_2
table(pred_2,titanic$Survived_value)
misClassifiError = mean(pred_2 != titanic$Survived_value)
print(paste('Accuracy', 1 - misClassifiError))
pred_2 = rep("Died", 564)
pred_2[titanic$prob_2>0.48] = "Survived"
titanic$pred_2 <- pred_2
table(pred_2,titanic$Survived_value)
misClassifiError = mean(pred_2 != titanic$Survived_value)
print(paste('Accuracy', 1 - misClassifiError))
pred_2 = rep("Died", 564)
pred_2[titanic$prob_2>0.40] = "Survived"
titanic$pred_2 <- pred_2
table(pred_2,titanic$Survived_value)
misClassifiError = mean(pred_2 != titanic$Survived_value)
print(paste('Accuracy', 1 - misClassifiError))
pred_2 = rep("Died", 564)
pred_2[titanic$prob_2>0.55] = "Survived"
titanic$pred_2 <- pred_2
table(pred_2,titanic$Survived_value)
misClassifiError = mean(pred_2 != titanic$Survived_value)
print(paste('Accuracy', 1 - misClassifiError))
pred_2 = rep("Died", 564)
pred_2[titanic$prob_2>0.50] = "Survived"
titanic$pred_2 <- pred_2
table(pred_2,titanic$Survived_value)
misClassifiError = mean(pred_2 != titanic$Survived_value)
print(paste('Accuracy', 1 - misClassifiError))
titanic_2 <- glm(Survived ~ female + Class_1 + Age_0_10 + SibSp_isMulti + Parch_isOne, family=binomial, data=titanic)
summary(titanic_2)
exp(coef(titanic_2))
prob_2 = predict(titanic_2,type="response")
titanic$prob_2 <- prob_2
quantile(titanic$prob_2)
# (2) Run Diagnostics
pred_2 = rep("Died", 564)
pred_2[titanic$prob_2>0.50] = "Survived"
titanic$pred_2 <- pred_2
table(pred_2,titanic$Survived_value)
misClassifiError = mean(pred_2 != titanic$Survived_value)
print(paste('Accuracy', 1 - misClassifiError))
titanic_2 <- glm(Survived ~ female + Class_1 + Class_2 + Class_3 + Age_0_10 + SibSp_isMulti, family=binomial, data=titanic)
summary(titanic_2)
exp(coef(titanic_2))
prob_2 = predict(titanic_2,type="response")
titanic$prob_2 <- prob_2
quantile(titanic$prob_2)
# (2) Run Diagnostics
pred_2 = rep("Died", 564)
pred_2[titanic$prob_2>0.50] = "Survived"
titanic$pred_2 <- pred_2
table(pred_2,titanic$Survived_value)
misClassifiError = mean(pred_2 != titanic$Survived_value)
print(paste('Accuracy', 1 - misClassifiError))
titanic_2 <- glm(Survived ~ female + Class_1 + Class_2 + Age_0_10 + Age_11_20 + Age_21_30 + Age_31_40 + SibSp_isMulti, family=binomial, data=titanic)
summary(titanic_2)
exp(coef(titanic_2))
prob_2 = predict(titanic_2,type="response")
titanic$prob_2 <- prob_2
quantile(titanic$prob_2)
# (2) Run Diagnostics
pred_2 = rep("Died", 564)
pred_2[titanic$prob_2>0.50] = "Survived"
titanic$pred_2 <- pred_2
table(pred_2,titanic$Survived_value)
misClassifiError = mean(pred_2 != titanic$Survived_value)
print(paste('Accuracy', 1 - misClassifiError))
titanic_2 <- glm(Survived ~ female + Class_1 + Class_2 + Age_0_10 + Age_11_20 + Age_21_30 + Age_31_40 + Age_41_50 + Age_51_60 + Age_61_70 + Age_71_110 + SibSp_isMulti, family=binomial, data=titanic)
summary(titanic_2)
exp(coef(titanic_2))
prob_2 = predict(titanic_2,type="response")
titanic$prob_2 <- prob_2
quantile(titanic$prob_2)
# (2) Run Diagnostics
pred_2 = rep("Died", 564)
pred_2[titanic$prob_2>0.50] = "Survived"
titanic$pred_2 <- pred_2
table(pred_2,titanic$Survived_value)
misClassifiError = mean(pred_2 != titanic$Survived_value)
print(paste('Accuracy', 1 - misClassifiError))
titanic_2 <- glm(Survived ~ female + Class_1 + Class_2 + Age_0_10 + Age_11_20 + Age_21_30 + Age_31_40 + Age_41_50 + Age_51_60 + Age_61_70 + SibSp_isMulti, family=binomial, data=titanic)
summary(titanic_2)
exp(coef(titanic_2))
prob_2 = predict(titanic_2,type="response")
titanic$prob_2 <- prob_2
quantile(titanic$prob_2)
# (2) Run Diagnostics
pred_2 = rep("Died", 564)
pred_2[titanic$prob_2>0.50] = "Survived"
titanic$pred_2 <- pred_2
table(pred_2,titanic$Survived_value)
misClassifiError = mean(pred_2 != titanic$Survived_value)
print(paste('Accuracy', 1 - misClassifiError))
titanic_2 <- glm(Survived ~ female + Class_1 + Class_2 + Age_0_10 + Age_11_20 + Age_21_30 + Age_31_40 + Age_41_50 + Age_51_60 + SibSp_isMulti, family=binomial, data=titanic)
summary(titanic_2)
exp(coef(titanic_2))
prob_2 = predict(titanic_2,type="response")
titanic$prob_2 <- prob_2
quantile(titanic$prob_2)
# (2) Run Diagnostics
pred_2 = rep("Died", 564)
pred_2[titanic$prob_2>0.50] = "Survived"
titanic$pred_2 <- pred_2
table(pred_2,titanic$Survived_value)
misClassifiError = mean(pred_2 != titanic$Survived_value)
print(paste('Accuracy', 1 - misClassifiError))
titanic_2 <- glm(Survived ~ female + Class_1 + Class_2 + Age_0_10 + Age_11_20 + Age_21_30 + Age_31_40 + Age_41_50 + SibSp_isMulti, family=binomial, data=titanic)
summary(titanic_2)
exp(coef(titanic_2))
prob_2 = predict(titanic_2,type="response")
titanic$prob_2 <- prob_2
quantile(titanic$prob_2)
# (2) Run Diagnostics
pred_2 = rep("Died", 564)
pred_2[titanic$prob_2>0.50] = "Survived"
titanic$pred_2 <- pred_2
table(pred_2,titanic$Survived_value)
misClassifiError = mean(pred_2 != titanic$Survived_value)
print(paste('Accuracy', 1 - misClassifiError))
titanic_2 <- glm(Survived ~ female + Class_1 + Class_2 + Age_0_10 + Age_11_20 + Age_21_30 + Age_31_40 + SibSp_isMulti, family=binomial, data=titanic)
summary(titanic_2)
exp(coef(titanic_2))
prob_2 = predict(titanic_2,type="response")
titanic$prob_2 <- prob_2
quantile(titanic$prob_2)
# (2) Run Diagnostics
pred_2 = rep("Died", 564)
pred_2[titanic$prob_2>0.50] = "Survived"
titanic$pred_2 <- pred_2
table(pred_2,titanic$Survived_value)
misClassifiError = mean(pred_2 != titanic$Survived_value)
print(paste('Accuracy', 1 - misClassifiError))
titanic_2 <- glm(Survived ~ female + Class_1 + Class_2 + Age_0_10 + Age_11_20 + Age_21_30 + Age_31_40 + SibSp_isOne + SibSp_isMulti, family=binomial, data=titanic)
summary(titanic_2)
exp(coef(titanic_2))
prob_2 = predict(titanic_2,type="response")
titanic$prob_2 <- prob_2
quantile(titanic$prob_2)
# (2) Run Diagnostics
pred_2 = rep("Died", 564)
pred_2[titanic$prob_2>0.50] = "Survived"
titanic$pred_2 <- pred_2
table(pred_2,titanic$Survived_value)
misClassifiError = mean(pred_2 != titanic$Survived_value)
print(paste('Accuracy', 1 - misClassifiError))
titanic_2 <- glm(Survived ~ female + Class_1 + Class_2 + Age_0_10 + Age_11_20 + Age_21_30 + Age_31_40 + SibSp_isMulti, + Parch_isMulti + Parch_isOne, family=binomial, data=titanic)
summary(titanic_2)
exp(coef(titanic_2))
prob_2 = predict(titanic_2,type="response")
titanic$prob_2 <- prob_2
quantile(titanic$prob_2)
# (2) Run Diagnostics
pred_2 = rep("Died", 564)
pred_2[titanic$prob_2>0.50] = "Survived"
titanic$pred_2 <- pred_2
table(pred_2,titanic$Survived_value)
misClassifiError = mean(pred_2 != titanic$Survived_value)
print(paste('Accuracy', 1 - misClassifiError))
titanic_2 <- glm(Survived ~ female + Class_1 + Class_2 + Age_0_10 + Age_11_20 + Age_21_30 + Age_31_40 + SibSp_isMulti, + Parch_isMulti + Parch_isOne, family=binomial, data=titanic)
titanic_2 <- glm(Survived ~ female + Class_1 + Class_2 + Age_0_10 + Age_11_20 + Age_21_30 + Age_31_40 + SibSp_isMulti + Parch_isMulti + Parch_isOne, family=binomial, data=titanic)
summary(titanic_2)
exp(coef(titanic_2))
prob_2 = predict(titanic_2,type="response")
titanic$prob_2 <- prob_2
quantile(titanic$prob_2)
# (2) Run Diagnostics
pred_2 = rep("Died", 564)
pred_2[titanic$prob_2>0.50] = "Survived"
titanic$pred_2 <- pred_2
table(pred_2,titanic$Survived_value)
misClassifiError = mean(pred_2 != titanic$Survived_value)
print(paste('Accuracy', 1 - misClassifiError))
titanic_2 <- glm(Survived ~ female + Class_1 + Class_2 + Age_0_10 + Age_11_20 + Age_21_30 + Age_31_40 + SibSp_isMulti + isHighFare, family=binomial, data=titanic)
summary(titanic_2)
exp(coef(titanic_2))
prob_2 = predict(titanic_2,type="response")
titanic$prob_2 <- prob_2
quantile(titanic$prob_2)
# (2) Run Diagnostics
pred_2 = rep("Died", 564)
pred_2[titanic$prob_2>0.50] = "Survived"
titanic$pred_2 <- pred_2
table(pred_2,titanic$Survived_value)
misClassifiError = mean(pred_2 != titanic$Survived_value)
print(paste('Accuracy', 1 - misClassifiError))
titanic_2 <- glm(Survived ~ female + Class_1 + Class_2 + Age_0_10 + Age_11_20 + Age_21_30 + Age_31_40 + SibSp_isMulti, family=binomial, data=titanic)
summary(titanic_2)
exp(coef(titanic_2))
prob_2 = predict(titanic_2,type="response")
titanic$prob_2 <- prob_2
quantile(titanic$prob_2)
# (2) Run Diagnostics
pred_2 = rep("Died", 564)
pred_2[titanic$prob_2>0.50] = "Survived"
titanic$pred_2 <- pred_2
table(pred_2,titanic$Survived_value)
misClassifiError = mean(pred_2 != titanic$Survived_value)
print(paste('Accuracy', 1 - misClassifiError))
exp(coef(titanic_2))
logisticPseudoR2s(titanic_2)
titanic_2 <- glm(Survived ~ female + Class_1 + Class_2 + Age_0_10 + Age_11_20 + Age_21_30 + Age_31_40 + SibSp_isMulti + Fare, family=binomial, data=titanic)
summary(titanic_2)
exp(coef(titanic_2))
prob_2 = predict(titanic_2,type="response")
titanic$prob_2 <- prob_2
quantile(titanic$prob_2)
# (2) Run Diagnostics
pred_2 = rep("Died", 564)
pred_2[titanic$prob_2>0.50] = "Survived"
titanic$pred_2 <- pred_2
table(pred_2,titanic$Survived_value)
misClassifiError = mean(pred_2 != titanic$Survived_value)
print(paste('Accuracy', 1 - misClassifiError))
exp(coef(titanic_2))
logisticPseudoR2s(titanic_2)
View(titanic)
prob_2 = predict(titanic_2,type="response")
titanic$prob_2 <- prob_2
quantile(titanic$prob_2)
pred_2 = rep("Died", 564)
pred_2[titanic$prob_2>0.50] = "Survived"
titanic$pred_2 <- pred_2
table(pred_2,titanic$Survived_value)
summary(titanic_2)
titanic_2 <- glm(Survived ~ female + Class_1 + Class_2 + Age_0_10 + Age_11_20 + Age_21_30 + Age_31_40 + SibSp_isMulti, family=binomial, data=titanic)
summary(titanic_2)
exp(coef(titanic_2))
prob_2 = predict(titanic_2,type="response")
titanic$prob_2 <- prob_2
quantile(titanic$prob_2)
summary(titanic_2)
exp(coef(titanic_2))
pred_2 = rep("Died", 564)
pred_2[titanic$prob_2>0.50] = "Survived"
titanic$pred_2 <- pred_2
table(pred_2,titanic$Survived_value)
table(pred_2,titanic$Survived_value)
table(pred_2,titanic$Survived_value)
misClassifiError = mean(pred_2 != titanic$Survived_value)
print(paste('Accuracy', 1 - misClassifiError))
titanic_final <- glm(Survived ~ female + Class_1 + Class_2 + Age_0_10 + Age_11_20 + Age_21_30 + Age_31_40 + SibSp_isMulti, family=binomial, data=titanic)
summary(titanic_final)
exp(coef(titanic_final))
prob_final = predict(titanic_final,type="response")
titanic$prob_final <- prob_final
quantile(titanic$prob_final)
# (2) Run Diagnostics
pred_final = rep("Died", 564)
pred_final[titanic$prob_final>0.50] = "Survived"
titanic$pred_final <- pred_final
table(pred_final,titanic$Survived_value)
misClassifiError = mean(pred_final != titanic$Survived_value)
print(paste('Accuracy', 1 - misClassifiError))
exp(coef(titanic_final))
logisticPseudoR2s(titanic_final)
roc_titanic <- roc(titanic$Survived_value,titanic$prob_final  )
plot(roc_titanic)
roc_titanic <- roc(titanic$Survived_value,titanic$prob_final)
roc_titanic <- plot.roc(titanic$Survived_value,titanic$prob_final)
plot(roc_titanic)
rocplot <- plot.roc(titanic$Survived_value,titanic$prob_final)
library(pROC)
rocplot <- plot.roc(titanic$Survived_value,titanic$prob_final)
plot(rocplot)
train <- read.csv("test_set.csv")
titanic <- train
View(titanic)
summary <- describe(titanic)
View(summary)
train3 = na.omit(train)
test <- read.csv("test_set.csv")
titanic <- test
View(titanic)
test3 = na.omit(test)
describe(test3)
titanic <- test3
titanic$Embarked_Q[titanic$Embarked == "Q"] <- 1 ; titanic$Embarked_Q[titanic$Embarked == "S"] <- 0 ; titanic$Embarked_Q[titanic$Embarked == "C"] <- 0
titanic$Embarked_S[titanic$Embarked == "Q"] <- 0 ; titanic$Embarked_S[titanic$Embarked == "S"] <- 1 ; titanic$Embarked_S[titanic$Embarked == "C"] <- 0
titanic$Embarked_C[titanic$Embarked == "Q"] <- 0 ; titanic$Embarked_C[titanic$Embarked == "S"] <- 0 ; titanic$Embarked_C[titanic$Embarked == "C"] <- 1
titanic$female[titanic$Sex == "male"] <- 0 ; titanic$female[titanic$Sex == "female"] <- 1
titanic$male[titanic$Sex == "female"] <- 0 ; titanic$male[titanic$Sex == "male"] <- 1
titanic$Class_1[titanic$Pclass == "1"] <- 1 ; titanic$Class_1[titanic$Pclass == "2"] <- 0 ; titanic$Class_1[titanic$Pclass == "3"] <- 0
titanic$Class_2[titanic$Pclass == "1"] <- 0 ; titanic$Class_2[titanic$Pclass == "2"] <- 1 ; titanic$Class_2[titanic$Pclass == "3"] <- 0
titanic$Class_3[titanic$Pclass == "1"] <- 0 ; titanic$Class_3[titanic$Pclass == "2"] <- 0 ; titanic$Class_3[titanic$Pclass == "3"] <- 1
titanic$SibSp_isMulti[titanic$SibSp > 1] <- 1 ; titanic$SibSp_isMulti[titanic$SibSp <= 1] <- 0 ;
titanic$SibSp_isOne[titanic$SibSp == 1] <- 1 ; titanic$SibSp_isOne[titanic$SibSp != 1] <- 0 ;
titanic$SibSp_isNone[titanic$SibSp == 0] <- 1 ; titanic$SibSp_isNone[titanic$SibSp > 0] <- 0 ;
titanic$Parch_isMulti[titanic$Parch > 1] <- 1 ; titanic$Parch_isMulti[titanic$Parch <= 1] <- 0 ;
titanic$Parch_isOne[titanic$Parch == 1] <- 1 ; titanic$Parch_isOne[titanic$Parch != 1] <- 0 ;
titanic$Parch_isNone[titanic$Parch == 0] <- 1 ; titanic$Parch_isNone[titanic$Parch > 0] <- 0 ;
titanic$Age_0_10[titanic$Age > 0]<- 0 ; titanic$Age_0_10[titanic$Age <=10] <- 1 ;
titanic$Age_11_20[titanic$Age > 0] <- 0 ; titanic$Age_11_20[titanic$Age > 10 & titanic$Age <=20 ] <- 1 ;
titanic$Age_21_30[titanic$Age > 0] <- 0 ; titanic$Age_21_30[titanic$Age > 20 & titanic$Age <=30 ] <- 1 ;
titanic$Age_31_40[titanic$Age > 0] <- 0 ; titanic$Age_31_40[titanic$Age > 30 & titanic$Age <=40 ] <- 1 ;
titanic$Age_41_50[titanic$Age > 0] <- 0 ; titanic$Age_41_50[titanic$Age > 40 & titanic$Age <=50 ] <- 1 ;
titanic$Age_51_60[titanic$Age > 0] <- 0 ; titanic$Age_51_60[titanic$Age > 50 & titanic$Age <=60 ] <- 1 ;
titanic$Age_61_70[titanic$Age > 0] <- 0 ; titanic$Age_61_70[titanic$Age > 60 & titanic$Age <=70 ] <- 1 ;
titanic$Age_71_110[titanic$Age > 0] <- 0 ; titanic$Age_71_110[titanic$Age > 70 & titanic$Age <=110 ] <- 1 ;
#upper quartile for high fare
titanic$isHighFare[titanic$Fare >=120] <- 1 ; titanic$isHighFare[titanic$Fare < 120 ] <- 0 ;
titanic$Survived_value[titanic$Survived == 0] <- "Died" ; titanic$Survived_value[titanic$Survived == 1] <- "Survived"
View(titanic)
titanic_final <- glm(Survived ~ female + Class_1 + Class_2 + Age_0_10 + Age_11_20 + Age_21_30 + Age_31_40 + SibSp_isMulti, family=binomial, data=titanic)
summary(titanic_final)
exp(coef(titanic_final))
prob_final = predict(titanic_final,type="response")
titanic$prob_final <- prob_final
prob_final = predict(titanic_final,type="response")
titanic$prob_final <- prob_final
quantile(titanic$prob_final)
pred_final = rep("Died", 564)
pred_final[titanic$prob_final>0.50] = "Survived"
titanic$pred_final <- pred_final
table(pred_final,titanic$Survived_value)
misClassifiError = mean(pred_final != titanic$Survived_value)
print(paste('Accuracy', 1 - misClassifiError))
prob_final = predict(titanic_final,type="response")
titanic$prob_final <- prob_final
pred_1 = rep("Died", 148) # Creates a vector of 564 "Died" elements
pred_1[titanic$prob_1>0.5] = "Survived" # Changes the "Died" elements to "Survived" if probability is above 0.5
pred_1[0:40]
titanic$pred_1 <- pred_1
table(titanic$pred_1)
table(pred_1,titanic$Survived_value) # Confusion table that compares our prediction to the Survived that was reality. How many false positves/negatives do you have?
misClassifiError = mean(pred_1 != titanic$Survived_value)
print(paste('Accuracy', 1 - misClassifiError))
prob_final = predict(titanic_final,type="response")
titanic$prob_final <- prob_final
quantile(titanic$prob_final)
pred_final = rep("Died", 148)
pred_final[titanic$prob_final>0.50] = "Survived"
titanic$pred_final <- pred_final
table(pred_final,titanic$Survived_value)
misClassifiError = mean(pred_final != titanic$Survived_value)
print(paste('Accuracy', 1 - misClassifiError))
titanic_final <- glm(Survived ~ female + Class_1 + Class_2 + Age_0_10 + Age_11_20 + Age_21_30 + Age_31_40 + SibSp_isMulti, family=binomial, data=titanic)
summary(titanic_final)
exp(coef(titanic_final))
prob_final = predict(titanic_final,type="response")
titanic$prob_final <- prob_final
quantile(titanic$prob_final)
# (2) Run Diagnostics
pred_final = rep("Died", 148)
pred_final[titanic$prob_final>0.50] = "Survived"
titanic$pred_final <- pred_final
table(pred_final,titanic$Survived_value)
misClassifiError = mean(pred_final != titanic$Survived_value)
print(paste('Accuracy', 1 - misClassifiError))
exp(coef(titanic_final))
logisticPseudoR2s(titanic_final)
rocplot <- plot.roc(titanic$Survived_value,titanic$prob_final)
plot(rocplot)
train <- read.csv("train_set.csv")
titanic_train <- train
View(titanic_train)
test <- read.csv("test_set.csv")
titanic_test <- test
View(titanic_test)
train = na.omit(titanic_train)
describe(train)
test = na.omit(titanic_test)
describe(test)
titanic_train <- train
titanic_test <- test
titanic <- train
titanic_test <- test
titanic$Embarked_Q[titanic$Embarked == "Q"] <- 1 ; titanic$Embarked_Q[titanic$Embarked == "S"] <- 0 ; titanic$Embarked_Q[titanic$Embarked == "C"] <- 0
titanic$Embarked_S[titanic$Embarked == "Q"] <- 0 ; titanic$Embarked_S[titanic$Embarked == "S"] <- 1 ; titanic$Embarked_S[titanic$Embarked == "C"] <- 0
titanic$Embarked_C[titanic$Embarked == "Q"] <- 0 ; titanic$Embarked_C[titanic$Embarked == "S"] <- 0 ; titanic$Embarked_C[titanic$Embarked == "C"] <- 1
titanic$female[titanic$Sex == "male"] <- 0 ; titanic$female[titanic$Sex == "female"] <- 1
titanic$male[titanic$Sex == "female"] <- 0 ; titanic$male[titanic$Sex == "male"] <- 1
titanic$Class_1[titanic$Pclass == "1"] <- 1 ; titanic$Class_1[titanic$Pclass == "2"] <- 0 ; titanic$Class_1[titanic$Pclass == "3"] <- 0
titanic$Class_2[titanic$Pclass == "1"] <- 0 ; titanic$Class_2[titanic$Pclass == "2"] <- 1 ; titanic$Class_2[titanic$Pclass == "3"] <- 0
titanic$Class_3[titanic$Pclass == "1"] <- 0 ; titanic$Class_3[titanic$Pclass == "2"] <- 0 ; titanic$Class_3[titanic$Pclass == "3"] <- 1
titanic$SibSp_isMulti[titanic$SibSp > 1] <- 1 ; titanic$SibSp_isMulti[titanic$SibSp <= 1] <- 0 ;
titanic$SibSp_isOne[titanic$SibSp == 1] <- 1 ; titanic$SibSp_isOne[titanic$SibSp != 1] <- 0 ;
titanic$SibSp_isNone[titanic$SibSp == 0] <- 1 ; titanic$SibSp_isNone[titanic$SibSp > 0] <- 0 ;
titanic$Parch_isMulti[titanic$Parch > 1] <- 1 ; titanic$Parch_isMulti[titanic$Parch <= 1] <- 0 ;
titanic$Parch_isOne[titanic$Parch == 1] <- 1 ; titanic$Parch_isOne[titanic$Parch != 1] <- 0 ;
titanic$Parch_isNone[titanic$Parch == 0] <- 1 ; titanic$Parch_isNone[titanic$Parch > 0] <- 0 ;
titanic$Age_0_10[titanic$Age > 0]<- 0 ; titanic$Age_0_10[titanic$Age <=10] <- 1 ;
titanic$Age_11_20[titanic$Age > 0] <- 0 ; titanic$Age_11_20[titanic$Age > 10 & titanic$Age <=20 ] <- 1 ;
titanic$Age_21_30[titanic$Age > 0] <- 0 ; titanic$Age_21_30[titanic$Age > 20 & titanic$Age <=30 ] <- 1 ;
titanic$Age_31_40[titanic$Age > 0] <- 0 ; titanic$Age_31_40[titanic$Age > 30 & titanic$Age <=40 ] <- 1 ;
titanic$Age_41_50[titanic$Age > 0] <- 0 ; titanic$Age_41_50[titanic$Age > 40 & titanic$Age <=50 ] <- 1 ;
titanic$Age_51_60[titanic$Age > 0] <- 0 ; titanic$Age_51_60[titanic$Age > 50 & titanic$Age <=60 ] <- 1 ;
titanic$Age_61_70[titanic$Age > 0] <- 0 ; titanic$Age_61_70[titanic$Age > 60 & titanic$Age <=70 ] <- 1 ;
titanic$Age_71_110[titanic$Age > 0] <- 0 ; titanic$Age_71_110[titanic$Age > 70 & titanic$Age <=110 ] <- 1 ;
#upper quartile for high fare
titanic$isHighFare[titanic$Fare >=120] <- 1 ; titanic$isHighFare[titanic$Fare < 120 ] <- 0 ;
titanic$Survived_value[titanic$Survived == 0] <- "Died" ; titanic$Survived_value[titanic$Survived == 1] <- "Survived"
View(titanic)
titanic_final <- glm(Survived ~ female + Class_1 + Class_2 + Age_0_10 + Age_11_20 + Age_21_30 + Age_31_40 + SibSp_isMulti, family=binomial, data=titanic)
summary(titanic_final)
exp(coef(titanic_final))
prob_final = predict(titanic_final, train, type="response")
titanic_test$Embarked_Q[titanic_test$Embarked == "Q"] <- 1 ; titanic_test$Embarked_Q[titanic_test$Embarked == "S"] <- 0 ; titanic_test$Embarked_Q[titanic_test$Embarked == "C"] <- 0
titanic_test$Embarked_S[titanic_test$Embarked == "Q"] <- 0 ; titanic_test$Embarked_S[titanic_test$Embarked == "S"] <- 1 ; titanic_test$Embarked_S[titanic_test$Embarked == "C"] <- 0
titanic_test$Embarked_C[titanic_test$Embarked == "Q"] <- 0 ; titanic_test$Embarked_C[titanic_test$Embarked == "S"] <- 0 ; titanic_test$Embarked_C[titanic_test$Embarked == "C"] <- 1
titanic_test$female[titanic_test$Sex == "male"] <- 0 ; titanic_test$female[titanic_test$Sex == "female"] <- 1
titanic_test$male[titanic_test$Sex == "female"] <- 0 ; titanic_test$male[titanic_test$Sex == "male"] <- 1
titanic_test$Class_1[titanic_test$Pclass == "1"] <- 1 ; titanic_test$Class_1[titanic_test$Pclass == "2"] <- 0 ; titanic_test$Class_1[titanic_test$Pclass == "3"] <- 0
titanic_test$Class_2[titanic_test$Pclass == "1"] <- 0 ; titanic_test$Class_2[titanic_test$Pclass == "2"] <- 1 ; titanic_test$Class_2[titanic_test$Pclass == "3"] <- 0
titanic_test$Class_3[titanic_test$Pclass == "1"] <- 0 ; titanic_test$Class_3[titanic_test$Pclass == "2"] <- 0 ; titanic_test$Class_3[titanic_test$Pclass == "3"] <- 1
titanic_test$SibSp_isMulti[titanic_test$SibSp > 1] <- 1 ; titanic_test$SibSp_isMulti[titanic_test$SibSp <= 1] <- 0 ;
titanic_test$SibSp_isOne[titanic_test$SibSp == 1] <- 1 ; titanic_test$SibSp_isOne[titanic_test$SibSp != 1] <- 0 ;
titanic_test$SibSp_isNone[titanic_test$SibSp == 0] <- 1 ; titanic_test$SibSp_isNone[titanic_test$SibSp > 0] <- 0 ;
titanic_test$Parch_isMulti[titanic_test$Parch > 1] <- 1 ; titanic_test$Parch_isMulti[titanic_test$Parch <= 1] <- 0 ;
titanic_test$Parch_isOne[titanic_test$Parch == 1] <- 1 ; titanic_test$Parch_isOne[titanic_test$Parch != 1] <- 0 ;
titanic_test$Parch_isNone[titanic_test$Parch == 0] <- 1 ; titanic_test$Parch_isNone[titanic_test$Parch > 0] <- 0 ;
titanic_test$Age_0_10[titanic_test$Age > 0]<- 0 ; titanic_test$Age_0_10[titanic_test$Age <=10] <- 1 ;
titanic_test$Age_11_20[titanic_test$Age > 0] <- 0 ; titanic_test$Age_11_20[titanic_test$Age > 10 & titanic_test$Age <=20 ] <- 1 ;
titanic_test$Age_21_30[titanic_test$Age > 0] <- 0 ; titanic_test$Age_21_30[titanic_test$Age > 20 & titanic_test$Age <=30 ] <- 1 ;
titanic_test$Age_31_40[titanic_test$Age > 0] <- 0 ; titanic_test$Age_31_40[titanic_test$Age > 30 & titanic_test$Age <=40 ] <- 1 ;
titanic_test$Age_41_50[titanic_test$Age > 0] <- 0 ; titanic_test$Age_41_50[titanic_test$Age > 40 & titanic_test$Age <=50 ] <- 1 ;
titanic_test$Age_51_60[titanic_test$Age > 0] <- 0 ; titanic_test$Age_51_60[titanic_test$Age > 50 & titanic_test$Age <=60 ] <- 1 ;
titanic_test$Age_61_70[titanic_test$Age > 0] <- 0 ; titanic_test$Age_61_70[titanic_test$Age > 60 & titanic_test$Age <=70 ] <- 1 ;
titanic_test$Age_71_110[titanic_test$Age > 0] <- 0 ; titanic_test$Age_71_110[titanic_test$Age > 70 & titanic_test$Age <=110 ] <- 1 ;
titanic_test$isHighFare[titanic_test$Fare >=120] <- 1 ; titanic_test$isHighFare[titanic_test$Fare < 120 ] <- 0 ;
titanic_test$Survived_value[titanic_test$Survived == 0] <- "Died" ; titanic_test$Survived_value[titanic_test$Survived == 1] <- "Survived"
prob_final = predict(titanic_final, train, type="response")
prob_final = predict(titanic_final, titanic_test, type="response")
titanic$prob_final <- prob_final
quantile(titanic$prob_final)
titanic_final <- glm(Survived ~ female + Class_1 + Class_2 + Age_0_10 + Age_11_20 + Age_21_30 + Age_31_40 + SibSp_isMulti, family=binomial, data=titanic)
summary(titanic_final)
exp(coef(titanic_final))
prob_final = predict(titanic_final, titanic_test, type="response")
titanic_test$prob_final <- prob_final
quantile(titanic_test$prob_final)
pred_final = rep("Died", 148)
pred_final[titanic_test$prob_final>0.50] = "Survived"
titanic_test$pred_final <- pred_final
table(pred_final,titanic_test$Survived_value)
misClassifiError = mean(pred_final != titanic_test$Survived_value)
print(paste('Accuracy', 1 - misClassifiError))
CrossTable(titanic$Pclass, titanic$Sex, titanic$Survived, expected = TRUE, format="SPSS")
train <- read.csv("train_set.csv")
titanic <- train
View(titanic)
train3 = na.omit(train)
describe(train3)
titanic <- train3
titanic$Embarked_Q[titanic$Embarked == "Q"] <- 1 ; titanic$Embarked_Q[titanic$Embarked == "S"] <- 0 ; titanic$Embarked_Q[titanic$Embarked == "C"] <- 0
titanic$Embarked_S[titanic$Embarked == "Q"] <- 0 ; titanic$Embarked_S[titanic$Embarked == "S"] <- 1 ; titanic$Embarked_S[titanic$Embarked == "C"] <- 0
titanic$Embarked_C[titanic$Embarked == "Q"] <- 0 ; titanic$Embarked_C[titanic$Embarked == "S"] <- 0 ; titanic$Embarked_C[titanic$Embarked == "C"] <- 1
titanic$female[titanic$Sex == "male"] <- 0 ; titanic$female[titanic$Sex == "female"] <- 1
titanic$male[titanic$Sex == "female"] <- 0 ; titanic$male[titanic$Sex == "male"] <- 1
titanic$Class_1[titanic$Pclass == "1"] <- 1 ; titanic$Class_1[titanic$Pclass == "2"] <- 0 ; titanic$Class_1[titanic$Pclass == "3"] <- 0
titanic$Class_2[titanic$Pclass == "1"] <- 0 ; titanic$Class_2[titanic$Pclass == "2"] <- 1 ; titanic$Class_2[titanic$Pclass == "3"] <- 0
titanic$Class_3[titanic$Pclass == "1"] <- 0 ; titanic$Class_3[titanic$Pclass == "2"] <- 0 ; titanic$Class_3[titanic$Pclass == "3"] <- 1
titanic$SibSp_isMulti[titanic$SibSp > 1] <- 1 ; titanic$SibSp_isMulti[titanic$SibSp <= 1] <- 0 ;
titanic$SibSp_isOne[titanic$SibSp == 1] <- 1 ; titanic$SibSp_isOne[titanic$SibSp != 1] <- 0 ;
titanic$SibSp_isNone[titanic$SibSp == 0] <- 1 ; titanic$SibSp_isNone[titanic$SibSp > 0] <- 0 ;
titanic$Parch_isMulti[titanic$Parch > 1] <- 1 ; titanic$Parch_isMulti[titanic$Parch <= 1] <- 0 ;
titanic$Parch_isOne[titanic$Parch == 1] <- 1 ; titanic$Parch_isOne[titanic$Parch != 1] <- 0 ;
titanic$Parch_isNone[titanic$Parch == 0] <- 1 ; titanic$Parch_isNone[titanic$Parch > 0] <- 0 ;
titanic$Age_0_10[titanic$Age > 0]<- 0 ; titanic$Age_0_10[titanic$Age <=10] <- 1 ;
titanic$Age_11_20[titanic$Age > 0] <- 0 ; titanic$Age_11_20[titanic$Age > 10 & titanic$Age <=20 ] <- 1 ;
titanic$Age_21_30[titanic$Age > 0] <- 0 ; titanic$Age_21_30[titanic$Age > 20 & titanic$Age <=30 ] <- 1 ;
titanic$Age_31_40[titanic$Age > 0] <- 0 ; titanic$Age_31_40[titanic$Age > 30 & titanic$Age <=40 ] <- 1 ;
titanic$Age_41_50[titanic$Age > 0] <- 0 ; titanic$Age_41_50[titanic$Age > 40 & titanic$Age <=50 ] <- 1 ;
titanic$Age_51_60[titanic$Age > 0] <- 0 ; titanic$Age_51_60[titanic$Age > 50 & titanic$Age <=60 ] <- 1 ;
titanic$Age_61_70[titanic$Age > 0] <- 0 ; titanic$Age_61_70[titanic$Age > 60 & titanic$Age <=70 ] <- 1 ;
titanic$Age_71_110[titanic$Age > 0] <- 0 ; titanic$Age_71_110[titanic$Age > 70 & titanic$Age <=110 ] <- 1 ;
pred_naive = rep("Died", 564) # Creates a vector of 564 "Died" elements
pred_naive[titanic$prob_naive>0.5] = "Survived" # Changes the "Died" elements to "Survived" if probability for that element from the model is above 0.5
pred_naive[1:40] # Prints the first 40 elements
titanic$pred_naive <- pred_naive # Adds our vector to our dataset so we can view it next to our data
titanic_final <- glm(Survived ~ female + Class_1 + Class_2 + Age_0_10 + Age_11_20 + Age_21_30 + Age_31_40 + SibSp_isMulti, family=binomial, data=titanic)
summary(titanic_final)
exp(coef(titanic_final))
